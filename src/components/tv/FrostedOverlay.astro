---
/**
 * FrostedOverlay.astro
 * Creates the "Frost Window" effect for the TV display.
 *
 * The screen appears as a frosted window pane, with a clear "wiped" area
 * in the center where the game content is visible. Uses mask-image to
 * create the effect without obscuring the center content.
 *
 * Frost intensity: Medium (blur 16px) as per user preference.
 */
---
<div class="frost-overlay" id="frost-overlay">
    <!-- The frosted edges -->
    <div class="frost-overlay__frost"></div>

    <!-- Frost crystal decorations - reduced to 2 corners for performance -->
    <div class="frost-overlay__crystal frost-overlay__crystal--tl"></div>
    <div class="frost-overlay__crystal frost-overlay__crystal--br"></div>

    <!-- Particles removed - WinterWoods snowflakes provide this effect -->
</div>

<style>
.frost-overlay {
    position: fixed;
    inset: 0;
    z-index: 5;
    pointer-events: none;
    overflow: hidden;
    contain: layout style; /* Limit reflow scope */
}

/* The frosted area with clear center */
/* PERFORMANCE: Removed backdrop-filter: blur() which was causing massive CPU usage.
   Using a semi-transparent gradient overlay instead for similar visual effect. */
.frost-overlay__frost {
    position: absolute;
    inset: 0;
    transform: translateZ(0); /* Force GPU layer */
    will-change: opacity;

    /* Frost effect using gradient instead of blur - much more performant */
    background: radial-gradient(
        ellipse 50% 55% at 50% 50%,
        transparent 0%,
        transparent 55%,
        rgba(200, 220, 240, 0.08) 70%,
        rgba(180, 210, 235, 0.15) 85%,
        rgba(160, 200, 230, 0.2) 100%
    );
}

/* Frost crystal decorations - GPU accelerated */
.frost-overlay__crystal {
    position: absolute;
    width: 150px;
    height: 150px;
    background: radial-gradient(
        ellipse at center,
        rgba(255, 255, 255, 0.08) 0%,
        rgba(200, 220, 240, 0.04) 40%,
        transparent 70%
    );
    opacity: 0.6;
    will-change: opacity, transform;
    transform: translateZ(0);
    animation: crystal-shimmer 10s ease-in-out infinite; /* Slower = less CPU */
}

.frost-overlay__crystal--tl {
    top: -30px;
    left: -30px;
}

.frost-overlay__crystal--br {
    bottom: -30px;
    right: -30px;
    animation-delay: 5s;
}

@keyframes crystal-shimmer {
    0%, 100% {
        opacity: 0.4;
        transform: translateZ(0) scale(1);
    }
    50% {
        opacity: 0.7;
        transform: translateZ(0) scale(1.1);
    }
}

/* Allow frost to be toggled off for certain views if needed */
.frost-overlay.frost-disabled {
    opacity: 0;
    transition: opacity 0.5s ease;
}
</style>
